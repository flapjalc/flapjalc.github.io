!function(m){m.fn.scratchie=function(e){var c={cursor:"/img/coin.png",cursorHeight:35,cursorWidth:35,target:"target",img:"/img/loto-priz.png",imgHeight:132,imgWidth:357,title:"Are you feeling lucky today?",fillColor:"#cc0000",fillImg:"loto.png",fillX:15,fillY:15,completion:35,uncoverOnComplete:!0,requireMouseClick:!0,callback:function(){alert("Congratulations!")}};e&&("object"==typeof e?m.extend(c,e):c.target=e);var u=!1,s=!1,a=overlaysUncovered=0,f=function(){return m().one("mouseup",function(){u=!1,m().unbind(),m(".scratch_overlay").bind("mousedown",f)}),!1},d=function(e){m("#cursor").css({left:e.clientX-2,top:e.clientY+2})},h=function(){return m("#cursor").show(),!1},g=function(){return m("#cursor").hide(),!1};return this.each(function(){var e,t,o,r,n,l;for(e=m(this),t=m("#"+c.target),e.css({cursor:"url(blank.cur), none",height:c.imgHeight+"px",width:c.imgWidth+"px"}),t.attr({alt:c.title,title:c.title,zIndex:1}).css({height:c.imgHeight+"px",width:c.imgWidth+"px"}).bind("mousedown",function(){return!1}),o=t.position(),tt=o.top,tl=o.left,n=l=0,e.after('<div id="cursor" style="cursor:none;width:'+c.cursorWidth+"px;height:"+c.cursorHeight+"px;position:fixed;display:none;top:0;left:0;z-index:10000;background:url("+c.cursor+') top left no-repeat;"></div>'),r="",i=0;i<c.imgWidth;i+=c.fillX){for(j=0;j<c.imgHeight;j+=c.fillY)++a,r+='<div class="scratch_overlay" style="z-index:100;height:'+c.fillY+"px;width:"+c.fillX+"px;position:absolute;border:0;overflow:hidden;top:"+(tt+j)+"px;left:"+(tl+i)+"px;background:",c.fillImg?(r+=" transparent url("+c.fillImg+") -"+n+"px -"+l+"px no-repeat;",l+=c.fillY):r+=c.fillColor,r+='"/>';c.fillImg&&(l=0,n+=c.fillX)}e.after(r),t.attr("src",c.img),m(".scratch_overlay").css("cursor","url(blank.cur), none"),t.bind("mouseout",function(){g()}).bind("mouseenter",function(){h()}).bind("mousemove",function(e){d(e)}),m(".scratch_overlay").bind("mouseout",function(){g()}).bind("mouseenter",function(){h()}).bind("mousemove",function(e){d(e)}),!0===c.requireMouseClick&&m(".scratch_overlay").bind("mousedown",function(){return u=!0,f(),!0===s&&(++overlaysUncovered,m(this).remove()),!1}),m(".scratch_overlay").bind("mouseover",function(){!0!==u&&!1!==c.requireMouseClick||(!0===s&&(++overlaysUncovered,m(this).remove()),overlaysUncovered/a*100>=c.completion&&(!0===c.uncoverOnComplete&&m(".scratch_overlay").remove(),c.callback()))}),s=!0}),this}}(jQuery);